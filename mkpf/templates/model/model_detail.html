{% extends 'new_template.html' %}

{% block style %}
tbody tr:hover{
background-color: #dc3545!important;
opacity:0.7;
color:white;
}
.platform a:hover{
    background-color: #dc3545!important;
    color:white;
}
h4:after{
    background-color: #dc3545!important;
}

{% endblock %}


{% block content %}
<section class="property-details-section">

    <div class="container" style="margin-top:60px;">
        <div class="row">
            <div class="col-lg-12">
                {% include "success.html" %}
                <div class="section-title" >
                    <h4>{{shoes.name}}</h4>
                </div>
                <div class="row" id="showPic">
                    <div class="col-3"></div>
                    <div class="col-lg-6 align-self-center" >
                        <img id="imgPic" src="{{url_for('static',filename='shoesmodels/{}'.format(shoes.img))}}">

                    </div>
                    <div class="col-3"></div>
                </div>


                <div class="pd-text">
                    <div class="row justify-content-between my-3">
                        <div class="col-2">
                            <select class="form-control so">
                                <option value="recent" {% if so=='recent' %}selected{% endif %}>최신순</option>
                                <option value="expensive" {% if so=='expensive' %}selected{% endif %}>가격순</option>
                                <option value="popular" {% if so=='popular' %}selected{% endif %}>사이즈순</option>
                            </select>
                        </div>
                        <div class="col-5 input-group" >
                            <span class="input-group-text form-control">최종갱신일 : {{search_date | datetime_detail}}</span>
                            <div class="input-group-append ">

                                <form method="post">
                                    {% if (now - search_date).total_seconds()/3600 < 1 %}
                                    <button class="btn btn-outline-secondary" disabled >1시간뒤 갱신가능</button>
                                    {% else %}
                                    <button class="btn btn-outline-secondary" type="submit" id="btn_search" onclick="$(this).SearchBtn();">업데이트</button>
                                    {%endif%}
                                </form>
                            </div>
                        </div>
                    </div>


                    <div class="table-responsive-md">

                        <table class="table table-bordered">
                            <thead style="background-color:#dc3545!important;">
                            <tr align="center" style="color:white;">
                                <th scope="col">No.</th>
                                <th scope="col">Size</th>
                                <th scope="col">Price</th>
                                <th scope="col">Date</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% if model_list %}

                            {% for model in model_list.items %}
                            <tr align="center" class="font-weight-normal">
                                <th scope="row">{{ model_list.total - ((model_list.page-1) * model_list.per_page) - loop.index0 }}</th>
                                <td>{{model.size}}</td>
                                <td>{{model.price |price}}</td>
                                <td>{{model.saleday|datetime}}</td>
                            </tr>
                            {% endfor %}
                            {% else %}
                            <tr>
                                <td colspan="3">데이터가 없습니다.</td>
                            </tr>
                            {% endif %}

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- 페이징처리 시작 -->
            <div class="col-lg-12">
                <div class="property-pagination">
                    <ul class="pagination justify-content-center thead-dark platform">
                        <!-- 이전페이지 -->
                        {% if model_list.has_prev %}
                        <a class="page-links icon" data-page="{{ model_list.prev_num }}" href="#"><span class="arrow_left"></span></a>
                        {% else %}
                        <span class="disabled">
                        <a class="page-links icon" tabindex="-1" aria-disabled="true" href="#"><span class="arrow_left"></span></a>
                    </span>
                        {% endif %}
                        {% for page_num in model_list.iter_pages() %}
                        {% if page_num %}
                        {% if page_num != model_list.page %}
                        <a class="page-links" data-page="{{ page_num }}" href="#">{{ page_num }}</a>
                        {% else %}
                        <span class="active"  aria-current="page">
                        <a class="page-links" style="background-color:#dc3545!important; color:white;" href="#">{{ page_num }}</a>
                    </span>
                        {% endif %}
                        {% else %}
                        <span class="disabled">
                        <a class="page-links" href="#">...</a>
                    </span>
                        {% endif %}
                        {% endfor %}
                        <!-- 다음페이지 -->
                        {% if model_list.has_next %}
                        <a class="page-links icon" data-page="{{ model_list.next_num }}" href="#"><span class="arrow_right"></span></a>
                        {% else %}
                        <span class="disabled">
                        <a class="page-links icon" tabindex="-1" aria-disabled="true" href="#"><span class="arrow_right"></span></a>
                    </span>
                        {% endif %}
                    </ul>

                    <!-- 페이징처리 끝 -->
                </div>
            </div>
        </div>
    </div>

    <form id="searchForm" method="get" action="{{ url_for('model.detail',code=code) }}">
        <input type="hidden" id="page" name="page" value="{{ page }}">
        <input type="hidden" id="so" name="so" value="{{ so }}">
    </form>
</section>
<!-- Property Section End -->
{% endblock %}

{% block script%}
<script type='text/javascript'>
$.fn.SearchBtn = function() {
        if (confirm('입력 하신내용으로 모델생성및 크롤링을 시작하시겠습니까?')){
        $('#btn_search').submit();
               $("#preloder").show();
               $("#loaders").show();
        } else {
            alert("취소하셨습니다.");
        }
};


$(document).ready(function(){


    $(".page-links").on('click', function() {
        $("#page").val($(this).data("page"));
        $("#searchForm").submit();
    });

    $(".so").on('change', function() {
        $("#so").val($(this).val());
        $("#page").val(1);
        $("#searchForm").submit();
    });

});
</script>
{% endblock %}
